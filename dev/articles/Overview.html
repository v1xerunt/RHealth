<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Descriptions • RHealth</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Descriptions">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RHealth</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/Overview.html">Overview</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/quickstart.html">Quickstart: In-Hospital Mortality Prediction with RHealth</a></li>
    <li><a class="dropdown-item" href="../articles/MedCode.html">DeepRHealth::medcode Module Demo</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/v1xerunt/RHealth/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Descriptions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/v1xerunt/RHealth/blob/dev/vignettes/Overview.Rmd" class="external-link"><code>vignettes/Overview.Rmd</code></a></small>
      <div class="d-none name"><code>Overview.Rmd</code></div>
    </div>

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div class="section level2">
<h2 id="rhealth">RHealth<a class="anchor" aria-label="anchor" href="#rhealth"></a>
</h2>
<!-- badges: start -->
<!-- badges: end -->
<p>RHealth is an open-source R package specifically designed to bring
comprehensive deep learning toolkits to the R community for healthcare
predictive modeling. Funded by the <a href="https://r-consortium.org/all-projects/2024-group-2.html#deeprhealth-a-deep-learning-toolkit-for-healthcare-predictive-modeling" class="external-link">ISC
grant from the R Consortium</a>, RHealth aims to provide an accessible,
integrated environment for R users.</p>
<p>This package is built upon its python version <a href="https://github.com/sunlabuiuc/PyHealth" class="external-link">PyHealth</a>.</p>
<div class="section level3">
<h3 id="citing-rhealth-handshake">Citing RHealth :handshake:<a class="anchor" aria-label="anchor" href="#citing-rhealth-handshake"></a>
</h3>
<p>Ji Song, Zhixia Ren, Zhenbang Wu, John Wu, Chaoqi Yang, Jimeng Sun,
Liantao Ma, Ewen M Harrison, and Junyi Gao. 2025. “RHealth: A Deep
Learning Toolkit for Healthcare Predictive Modeling”. GitHub.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bibtex"><code class="sourceCode bibtex"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="va">@misc</span>{<span class="ot">Ji2025</span>,</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="dt">author</span> = {Ji Song, Zhixia Ren, Zhenbang Wu, John Wu, Chaoqi Yang, Jimeng Sun, Liantao Ma, Ewen M Harrison, Junyi Gao},</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="dt">title</span> = {RHealth},</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="dt">year</span> = {2025},</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="dt">publisher</span> = {GitHub},</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="dt">journal</span> = {GitHub repository},</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="dt">howpublished</span> = {<span class="ch">\url</span>{https://github.com/v1xerunt/RHealth}}</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>You can install the development version of RHealth from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"RHealth"</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, using devtools:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"RHealth"</span><span class="op">)</span></span></code></pre></div>
<p>Once RHealth is installed, you can load the package to access medcode
functionalities:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://v1xerunt.github.io/dev/RHealth" class="external-link">RHealth</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dataset-module">1. Dataset Module<a class="anchor" aria-label="anchor" href="#dataset-module"></a>
</h3>
<p>The <strong>dataset</strong> module is the foundation of
<strong>RHealth</strong>.<br>
It converts raw, multi‑table Electronic‑Health‑Record (EHR) dumps into
tidy, task‑ready tensors that every downstream deep‑learning model can
consume.</p>
<hr>
<div class="section level4">
<h4 id="key-features">1.1 Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h4>
<table style="width:100%;" class="table">
<colgroup>
<col width="12%">
<col width="19%">
<col width="39%">
<col width="28%">
</colgroup>
<thead><tr class="header">
<th>Stage</th>
<th>Raw Input</th>
<th>Dataset Module Output</th>
<th>Why it Matters</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Ingestion</strong></td>
<td>One <em>CSV</em> (<code>.csv</code> / <code>.csv.gz</code>)
<strong>per clinical table</strong>
</td>
<td>A lazy <em>Polars</em> <code>LazyFrame</code> for each table</td>
<td>Streaming avoids loading GBs of text into RAM</td>
</tr>
<tr class="even">
<td><strong>Harmonisation</strong></td>
<td>Heterogeneous schemas, mixed timestamp formats, upper/lower‑case
headers</td>
<td>A single, canonical <strong>event table</strong>
with<br><code>patient_id</code>, <code>event_type</code>,
<code>timestamp</code>, <code>attr_*</code>
</td>
<td>Uniform layout lets every task, processor &amp; model share the same
rules</td>
</tr>
<tr class="odd">
<td><strong>Entity Split</strong></td>
<td>Monolithic event table</td>
<td>
<code>Patient</code> objects (one per subject)</td>
<td>Encapsulates per‑patient logic &amp; keeps memory steady</td>
</tr>
<tr class="even">
<td><strong>Task Sampling</strong></td>
<td>Arbitrary event streams</td>
<td>
<code>SampleDataset</code> (<strong>torch</strong>‑compatible)</td>
<td>Produces <code>(input, target)</code> pairs ready for a
<code>dataloader()</code>
</td>
</tr>
</tbody>
</table>
<ul>
<li>Built‑in <strong>CSV → Parquet</strong> caching via DuckDB (×10
faster reloads).<br>
</li>
<li>Optional <strong>dev mode</strong> – keep the first <em>N
patients</em> for lightning‑fast iteration.<br>
</li>
<li>Parallel sample generation with <strong>future</strong> &amp;
<strong>progressr</strong>.</li>
</ul>
<hr>
</div>
<div class="section level4">
<h4 id="quickstart-example">1.2 Quick‑Start Example<a class="anchor" aria-label="anchor" href="#quickstart-example"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BaseDataset.html">BaseDataset</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  root         <span class="op">=</span> <span class="st">"mimic4"</span>,</span>
<span>  tables       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patients"</span>, <span class="st">"admissions"</span>, <span class="st">"lab_events"</span><span class="op">)</span>,</span>
<span>  dataset_name <span class="op">=</span> <span class="st">"mimic4_ehr"</span>,</span>
<span>  dev          <span class="op">=</span> <span class="cn">TRUE</span>            <span class="co"># limit to 1 000 patients</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ds</span><span class="op">$</span><span class="fu">stats</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dataset : mimic4_ehr</span></span>
<span><span class="co">#&gt; Dev mode : TRUE</span></span>
<span><span class="co">#&gt; Patients : 1 000</span></span>
<span><span class="co">#&gt; Events   : 2 187 540</span></span></code></pre></div>
<p>Convert the dataset into a model‑ready
<code>SampleDataset</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">task</span>    <span class="op">&lt;-</span> <span class="va"><a href="../reference/Readmission30DaysMIMIC4.html">Readmission30DaysMIMIC4</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="va">ds</span><span class="op">$</span><span class="fu">set_task</span><span class="op">(</span><span class="va">task</span><span class="op">)</span></span>
<span></span>
<span><span class="va">loader</span>  <span class="op">&lt;-</span> <span class="fu">dataloader</span><span class="op">(</span><span class="va">samples</span>, batch_size <span class="op">=</span> <span class="fl">64</span>, shuffle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level4">
<h4 id="yaml-configuration">1.3 YAML Configuration<a class="anchor" aria-label="anchor" href="#yaml-configuration"></a>
</h4>
<p>Every dataset is described by a single YAML file.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">"1.4"</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">tables</span><span class="kw">:</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="at">  </span><span class="fu">admissions</span><span class="kw">:</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="at">    </span><span class="fu">file_path</span><span class="kw">:</span><span class="at"> </span><span class="st">"ADMISSIONS.csv.gz"</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="at">    </span><span class="fu">patient_id</span><span class="kw">:</span><span class="at"> </span><span class="st">"subject_id"</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="at">    </span><span class="fu">timestamp</span><span class="kw">:</span><span class="at"> </span><span class="st">"admittime"</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="at">    </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> hadm_id</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> admission_type</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> discharge_location</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="at">    </span><span class="fu">join</span><span class="kw">:</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">file_path</span><span class="kw">:</span><span class="at"> </span><span class="st">"ICUSTAYS.csv.gz"</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="at">        </span><span class="fu">on</span><span class="kw">:</span><span class="at"> hadm_id</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="at">        </span><span class="fu">how</span><span class="kw">:</span><span class="at"> left</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="at">        </span><span class="fu">columns</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">icustay_id</span><span class="kw">,</span><span class="at"> first_careunit</span><span class="kw">]</span></span></code></pre></div>
<ul>
<li>
<strong><code>file_path</code></strong> – relative to
<code>root</code> or an HTTP(S) URL.<br>
</li>
<li>
<strong><code>patient_id</code></strong> – column containing the
subject identifier.<br>
</li>
<li>
<strong><code>timestamp</code></strong> – single column or list of
columns (concatenated).<br>
</li>
<li>
<strong><code>attributes</code></strong> – columns to expose;
automatically renamed to <code>table/column</code>.<br>
</li>
<li>
<strong><code>join</code></strong> – optional list of auxiliary
tables to merge in one pass.</li>
</ul>
<p>Load &amp; validate from R:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cfg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_yaml_config.html">load_yaml_config</a></span><span class="op">(</span><span class="st">"configs/mimic4_ehr.yaml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cfg</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level4">
<h4 id="patient-event-classes">1.4 Patient &amp; Event Classes<a class="anchor" aria-label="anchor" href="#patient-event-classes"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode txt"><code class="sourceCode default"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>BaseDataset            # keeper of *all events*</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a> └── Patient           # one subject’s events (lazy filtered)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>      └── Event        # lightweight list of {type, timestamp, attributes}</span></code></pre></div>
<p><em>A <code>Patient</code> behaves like a mini‑dataset: you can query
visits, length‑of‑stay, time‑series windows, … without touching any
other patient’s data.</em></p>
<hr>
</div>
<div class="section level4">
<h4 id="sampledataset-torch-integration">1.5 SampleDataset &amp; Torch Integration<a class="anchor" aria-label="anchor" href="#sampledataset-torch-integration"></a>
</h4>
<p><code>BaseDataset$set_task()</code> applies a user‑defined
<strong>BaseTask</strong>:</p>
<ol style="list-style-type: decimal">
<li>
<strong><code>pre_filter()</code></strong> – drop events or patients
globally.<br>
</li>
<li>
<strong><code>call(patient)</code></strong> – returns zero, one, or
many <code>(input, target)</code> pairs.<br>
</li>
<li>Each field is converted by its declared <strong>Processor</strong>
into a <code>torch_tensor</code>.</li>
</ol>
<p>The resulting <code>SampleDataset</code> supports:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">.__getitem__</span><span class="op">(</span><span class="va">i</span><span class="op">)</span>  <span class="co"># single sample</span></span>
<span><span class="fu">.__len__</span><span class="op">(</span><span class="op">)</span>       <span class="co"># length</span></span></code></pre></div>
<p>and plugs straight into <a href="https://torch.mlverse.org/docs" class="external-link">torch</a>’s
<code>dataloader()</code>.</p>
<hr>
</div>
<div class="section level4">
<h4 id="debugging-tips">1.6 Debugging Tips<a class="anchor" aria-label="anchor" href="#debugging-tips"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inspect the first 20 events</span></span>
<span><span class="va">ds</span><span class="op">$</span><span class="fu">unique_patient_ids</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine one patient</span></span>
<span><span class="va">pat</span> <span class="op">&lt;-</span> <span class="va">ds</span><span class="op">$</span><span class="fu">get_patient</span><span class="op">(</span><span class="st">"123456"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pat</span><span class="op">)</span></span></code></pre></div>
<p>Use <code>dev = TRUE</code> during development to keep iteration
times under 2 s.</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="task-moudle">2. Task Moudle<a class="anchor" aria-label="anchor" href="#task-moudle"></a>
</h3>
<p>The <strong>task</strong> module sits between the
<strong>dataset</strong> layer and your deep‑learning
<strong>models</strong>. A <em>task</em> tells RHealth
<strong>what</strong> to predict, <strong>which</strong> slices of data
to use, and <strong>how</strong> to turn a patient’s raw events into
<code>(input, target)</code> samples.</p>
<hr>
<div class="section level4">
<h4 id="conceptual-overview">2.1 Conceptual Overview<a class="anchor" aria-label="anchor" href="#conceptual-overview"></a>
</h4>
<ul>
<li>
<strong>BaseDataset</strong> provides lazy access to every patient’s
events.<br>
</li>
<li>A <strong>BaseTask</strong> instance decides:
<ol style="list-style-type: decimal">
<li>
<em>Which</em> events matter (<code>pre_filter()</code>).</li>
<li>
<em>How</em> to aggregate a patient’s timeline into one or more
<strong>samples</strong> (<code><a href="https://rdrr.io/r/base/call.html" class="external-link">call()</a></code>).</li>
<li>The exact <strong>input/output schema</strong> so RHealth can choose
the right <strong>Processor</strong> and encode data into <em>torch
tensors</em>.</li>
</ol>
</li>
<li>The resulting <strong>SampleDataset</strong> plugs straight into
<a href="https://torch.mlverse.org/docs" class="external-link">torch</a>.</li>
</ul>
<hr>
</div>
<div class="section level4">
<h4 id="basetask-api">2.2 <code>BaseTask</code> API<a class="anchor" aria-label="anchor" href="#basetask-api"></a>
</h4>
<table class="table">
<colgroup>
<col width="47%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th>Member</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<code>task_name</code> (<em>chr</em>)</td>
<td>Unique key shown in logs &amp; file names.</td>
</tr>
<tr class="even">
<td>
<code>input_schema</code> (<em>named list</em>)</td>
<td>Field → <em>processor type</em> (<code>"timeseries"</code>,
<code>"sequence"</code>, <code>"float"</code>, …).</td>
</tr>
<tr class="odd">
<td>
<code>output_schema</code> (<em>named list</em>)</td>
<td>Usually <code>"binary"</code>, <code>"multiclass"</code>,
<code>"regression"</code>, etc.</td>
</tr>
<tr class="even">
<td><code>pre_filter(df)</code></td>
<td>
<strong>Optional</strong>. Receives the <em>global</em> event
<code>LazyFrame</code>; return a pared‑down version to speed up
sampling.</td>
</tr>
<tr class="odd">
<td><code>call(patient)</code></td>
<td>
<strong>Must override</strong>. Converts one <code>Patient</code> to
zero, one, or many <strong>samples</strong> <em>(named lists)</em>.</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Skeleton for your own task ----------------------------------------------</span></span>
<span><span class="va">MyCoolTask</span> <span class="op">&lt;-</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></span><span class="op">(</span></span>
<span>  <span class="st">"MyCoolTask"</span>,</span>
<span>  inherit <span class="op">=</span> <span class="va">BaseTask</span>,</span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">super</span><span class="op">$</span><span class="fu">initialize</span><span class="op">(</span></span>
<span>        task_name     <span class="op">=</span> <span class="st">"MyCoolTask"</span>,</span>
<span>        input_schema  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>labs <span class="op">=</span> <span class="st">"timeseries"</span>,</span>
<span>                             diagnoses <span class="op">=</span> <span class="st">"sequence"</span><span class="op">)</span>,</span>
<span>        output_schema <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>outcome <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span></span>
<span>    pre_filter <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># keep only labs &amp; diagnoses to save RAM</span></span>
<span>      <span class="va">df</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="va">pl</span><span class="op">$</span><span class="fu">col</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"labevents/valuenum"</span>,</span>
<span>                         <span class="st">"diagnoses_icd/icd_code"</span>,</span>
<span>                         <span class="st">"timestamp"</span>,</span>
<span>                         <span class="st">"patient_id"</span>,</span>
<span>                         <span class="st">"event_type"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span></span>
<span>    call <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">patient</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># ... build samples here ...</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level4">
<h4 id="processor-autoselection">2.3 Processor Auto‑Selection<a class="anchor" aria-label="anchor" href="#processor-autoselection"></a>
</h4>
<p>During <code>BaseDataset$set_task(task)</code> RHealth:</p>
<ol style="list-style-type: decimal">
<li>Reads <code>task$input_schema</code> /
<code>task$output_schema</code>.<br>
</li>
<li>Calls <code>get_processor(type)</code> to instantiate the matching
<strong>Processor</strong> (<code>TimeseriesProcessor</code>,
<code>SequenceProcessor</code>, …).<br>
</li>
<li>Each sample emitted by <code>task$call()</code> is <strong>encoded
on the fly</strong> into <code>torch_tensor</code>s before being stored
in the <code>SampleDataset</code>.</li>
</ol>
<p>That means you never import <a href="https://torch.mlverse.org/docs" class="external-link">torch</a> inside a task –
stick to base R objects (<code>numeric</code>, <code>character</code>,
<code>matrix</code>, <code>data.frame</code>, lists).</p>
<hr>
</div>
<div class="section level4">
<h4 id="builtin-example-tasks">2.4 Built‑in Example Tasks<a class="anchor" aria-label="anchor" href="#builtin-example-tasks"></a>
</h4>
<table class="table">
<colgroup>
<col width="24%">
<col width="27%">
<col width="48%">
</colgroup>
<thead><tr class="header">
<th>Class</th>
<th>Target</th>
<th>Key Features</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>InHospitalMortalityMIMIC4</code></td>
<td>Mortality at discharge</td>
<td>Uses <strong>lab time‑series</strong> from the first 48 h; excludes
minors; binary label <code>mortality</code>.</td>
</tr>
<tr class="even">
<td><code>Readmission30DaysMIMIC4</code></td>
<td>30‑day readmission</td>
<td>Sequences of <strong>diagnoses / procedures / drugs</strong>;
ignores visits ≤ 12 h; smart exclusion of same‑day transfers.</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds</span>      <span class="op">&lt;-</span> <span class="va">MIMIC4Dataset</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>root <span class="op">=</span> <span class="st">"~/mimic4"</span>, tables <span class="op">=</span> <span class="va">...</span><span class="op">)</span></span>
<span><span class="va">mort30</span>  <span class="op">&lt;-</span> <span class="va"><a href="../reference/InHospitalMortalityMIMIC4.html">InHospitalMortalityMIMIC4</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>input_window_hours <span class="op">=</span> <span class="fl">48</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="va">ds</span><span class="op">$</span><span class="fu">set_task</span><span class="op">(</span><span class="va">mort30</span>, num_workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level4">
<h4 id="typical-workflow">2.5 Typical Workflow<a class="anchor" aria-label="anchor" href="#typical-workflow"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">task</span>    <span class="op">&lt;-</span> <span class="va">MyCoolTask</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="va">ds</span><span class="op">$</span><span class="fu">set_task</span><span class="op">(</span><span class="va">task</span><span class="op">)</span></span>
<span></span>
<span><span class="va">loader</span>  <span class="op">&lt;-</span> <span class="fu">dataloader</span><span class="op">(</span><span class="va">samples</span>, batch_size <span class="op">=</span> <span class="fl">64</span>, shuffle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">batch</span> <span class="kw">in</span> <span class="fu">enumerate</span><span class="op">(</span><span class="va">loader</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">model</span><span class="op">(</span><span class="va">batch</span><span class="op">$</span><span class="va">inputs</span><span class="op">)</span></span>
<span>  <span class="va">loss</span>   <span class="op">&lt;-</span> <span class="fu">nnf_binary_cross_entropy_with_logits</span><span class="op">(</span><span class="va">output</span>, <span class="va">batch</span><span class="op">$</span><span class="va">targets</span><span class="op">)</span></span>
<span>  <span class="co"># back‑prop …</span></span>
<span><span class="op">}</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="model-module">3 Model Module<a class="anchor" aria-label="anchor" href="#model-module"></a>
</h3>
<p>The <strong>model</strong> module delivers ready‑to‑train
neural‑network architectures and a thin <strong>BaseModel</strong>
contract that keeps every model compatible with the rest of RHealth.</p>
<hr>
<div class="section level4">
<h4 id="basemodel">3.1 BaseModel<a class="anchor" aria-label="anchor" href="#basemodel"></a>
</h4>
<p>Every RHealth model must be able to:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Understand the dataset</strong> – read the input/output
schema and work out dimensions automatically.</li>
<li>
<strong>Pick the right loss</strong> – binary, multiclass,
multilabel, regression.</li>
<li>
<strong>Turn logits into probabilities</strong> for validation
metrics.</li>
<li>Run on <strong>CPU or CUDA</strong> transparently.</li>
</ol>
<p><code>BaseModel</code> centralises those chores so concrete models
can focus on architecture.</p>
<hr>
</div>
<div class="section level4">
<h4 id="basemodel-api">3.2 <code>BaseModel</code> API<a class="anchor" aria-label="anchor" href="#basemodel-api"></a>
</h4>
<table class="table">
<colgroup>
<col width="47%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th>Member</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Fields</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>dataset</code></td>
<td>The <code>SampleDataset</code> used for training/validation.</td>
</tr>
<tr class="odd">
<td><code>feature_keys</code></td>
<td>Character vector from <code>dataset$input_schema</code>.</td>
</tr>
<tr class="even">
<td><code>label_keys</code></td>
<td>Character vector from <code>dataset$output_schema</code> (usually
length 1).</td>
</tr>
<tr class="odd">
<td><strong>Methods</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>get_output_size()</code></td>
<td>Returns the dimension expected at the final linear layer.</td>
</tr>
<tr class="odd">
<td><code>get_loss_function()</code></td>
<td>Picks between <code>nnf_binary_cross_entropy_with_logits</code>,
<code>nnf_cross_entropy</code>, …</td>
</tr>
<tr class="even">
<td><code>prepare_y_prob(logits)</code></td>
<td>Applies <code>sigmoid</code> / <code>softmax</code> / identity so
metrics receive proper probabilities.</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Rule of thumb</strong>: if your architecture only needs a
<em>forward</em> method and uses a single label, you can inherit from
<code>BaseModel</code> and forget about loss/prob helpers.</p>
</blockquote>
<hr>
</div>
<div class="section level4">
<h4 id="helper-building-blocks">3.3 Helper building blocks<a class="anchor" aria-label="anchor" href="#helper-building-blocks"></a>
</h4>
<div class="section level5">
<h5 id="embeddingmodel">3.3.1 <code>EmbeddingModel</code><a class="anchor" aria-label="anchor" href="#embeddingmodel"></a>
</h5>
<ul>
<li>Converts heterogeneous inputs to a <strong>shared embedding
space</strong>.
<ul>
<li>
<code>SequenceProcessor</code> → <code>nn_embedding</code>
</li>
<li>
<code>TimeseriesProcessor</code> → <code>nn_linear</code>
</li>
</ul>
</li>
<li>Pads sequences with index <code>0</code> and safely remaps it to
<code>padding_idx = 1</code>.</li>
</ul>
</div>
<div class="section level5">
<h5 id="rnnlayer">3.3.2 <code>RNNLayer</code><a class="anchor" aria-label="anchor" href="#rnnlayer"></a>
</h5>
<p>A drop‑in GRU/LSTM/RNN layer with:</p>
<ul>
<li>1‑based index safety (important in R!).</li>
<li>
<code>mask</code> support so you can mix sequences of different
length.</li>
<li>A learnable <code>null_hidden</code> vector for <strong>empty
sequences</strong> (avoids NaNs).</li>
<li>Bidirectional option with automatic hidden‑state merging.</li>
</ul>
<hr>
</div>
</div>
<div class="section level4">
<h4 id="reference-model-rnn">3.4 Reference model – <code>RNN</code><a class="anchor" aria-label="anchor" href="#reference-model-rnn"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode txt"><code class="sourceCode default"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>inputs  ─▶  EmbeddingModel  ─▶  per‑feature RNNLayer  ─┐</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>                                                      ├─▶ concat ─▶ FC ─▶ logits</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>labels   ──────────────────────────────────────────────┘</span></code></pre></div>
<ul>
<li>One <code>RNNLayer</code> <strong>per input feature</strong>
(diagnoses, procedures, labs …).</li>
<li>Hidden vectors are concatenated → <code>nn_linear</code> →
logits.</li>
<li>Works out‑of‑the‑box for <strong>binary / multi‑class /
regression</strong> tasks.</li>
</ul>
<p>Instantiation:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RNN.html">RNN</a></span><span class="op">(</span></span>
<span>  dataset       <span class="op">=</span> <span class="va">samples</span>,     <span class="co"># a SampleDataset from `set_task()`</span></span>
<span>  embedding_dim <span class="op">=</span> <span class="fl">128</span>,</span>
<span>  hidden_dim    <span class="op">=</span> <span class="fl">128</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level4">
<h4 id="quickstart-training-loop">3.5 Quick‑start training loop<a class="anchor" aria-label="anchor" href="#quickstart-training-loop"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">task</span>    <span class="op">&lt;-</span> <span class="va"><a href="../reference/Readmission30DaysMIMIC4.html">Readmission30DaysMIMIC4</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="va">ds</span><span class="op">$</span><span class="fu">set_task</span><span class="op">(</span><span class="va">task</span><span class="op">)</span></span>
<span></span>
<span><span class="va">loader</span>  <span class="op">&lt;-</span> <span class="fu">dataloader</span><span class="op">(</span><span class="va">samples</span>, batch_size <span class="op">=</span> <span class="fl">32</span>, shuffle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">model</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RNN.html">RNN</a></span><span class="op">(</span><span class="va">samples</span>, embedding_dim <span class="op">=</span> <span class="fl">128</span>, hidden_dim <span class="op">=</span> <span class="fl">128</span><span class="op">)</span></span>
<span><span class="va">optim</span>   <span class="op">&lt;-</span> <span class="fu">optim_adam</span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">parameters</span>, lr <span class="op">=</span> <span class="fl">1e-3</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">epoch</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">coro</span><span class="fu">::</span><span class="fu"><a href="https://coro.r-lib.org/reference/collect.html" class="external-link">loop</a></span><span class="op">(</span><span class="kw">for</span> <span class="op">(</span><span class="va">batch</span> <span class="kw">in</span> <span class="va">loader</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">optim</span><span class="op">$</span><span class="fu">zero_grad</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">out</span>  <span class="op">&lt;-</span> <span class="fu">model</span><span class="op">(</span><span class="va">batch</span><span class="op">)</span></span>
<span>    <span class="va">out</span><span class="op">$</span><span class="va">loss</span><span class="op">$</span><span class="fu">backward</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">optim</span><span class="op">$</span><span class="fu">step</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"epoch %d | loss %.4f\n"</span>, <span class="va">epoch</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">loss</span><span class="op">$</span><span class="fu">item</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<hr>
</div>
<div class="section level4">
<h4 id="writing-your-own-model">3.6 Writing your own model<a class="anchor" aria-label="anchor" href="#writing-your-own-model"></a>
</h4>
<ol style="list-style-type: decimal">
<li>
<strong>Subclass</strong> <code>BaseModel</code> (or another
concrete model).<br>
</li>
<li>Add layers in <code>initialize()</code>, making sure to call
<code>super$initialize(dataset)</code>.<br>
</li>
<li>Implement <code>forward(inputs)</code>.</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MyDense</span> <span class="op">&lt;-</span> <span class="fu">torch</span><span class="fu">::</span><span class="fu"><a href="https://torch.mlverse.org/docs/reference/nn_module.html" class="external-link">nn_module</a></span><span class="op">(</span></span>
<span>  <span class="st">"MyDense"</span>,</span>
<span>  inherit <span class="op">=</span> <span class="va">BaseModel</span>,</span>
<span></span>
<span>  initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">dataset</span>, <span class="va">hidden</span> <span class="op">=</span> <span class="fl">256</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">super</span><span class="op">$</span><span class="fu">initialize</span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span></span>
<span>    <span class="va">in_dim</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">input_processors</span>, <span class="st">"size"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">out_dim</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="fu">get_output_size</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">fc1</span> <span class="op">&lt;-</span> <span class="fu">nn_linear</span><span class="op">(</span><span class="va">in_dim</span>, <span class="va">hidden</span><span class="op">)</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">fc2</span> <span class="op">&lt;-</span> <span class="fu">nn_linear</span><span class="op">(</span><span class="va">hidden</span>, <span class="va">out_dim</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span></span>
<span>  forward <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">inputs</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Flatten and concat all features</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">torch</span><span class="fu">::</span><span class="fu"><a href="https://torch.mlverse.org/docs/reference/torch_cat.html" class="external-link">torch_cat</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu">flatten</span><span class="op">(</span><span class="va">inputs</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">logits</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="fu">fc2</span><span class="op">(</span><span class="fu">torch_relu</span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="fu">fc1</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      loss   <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="fu">get_loss_function</span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="va">logits</span>, <span class="va">inputs</span><span class="op">[[</span><span class="va">self</span><span class="op">$</span><span class="va">label_keys</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="fu">to</span><span class="op">(</span><span class="va">logits</span><span class="op">$</span><span class="va">device</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      y_prob <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="fu">prepare_y_prob</span><span class="op">(</span><span class="va">logits</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Checklist</strong>:</p>
<ul class="task-list">
<li><label><input type="checkbox" checked>Call
<code>super$initialize(dataset)</code><br></label></li>
<li><label><input type="checkbox" checked>Use
<code>self$get_output_size()</code> instead of hard‑coding
dimensions<br></label></li>
<li><label><input type="checkbox" checked>Return a <strong>named
list</strong> containing at least <code>loss</code>,
<code>y_prob</code></label></li>
</ul>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="trainer">4.Trainer<a class="anchor" aria-label="anchor" href="#trainer"></a>
</h3>
<p>The <strong>Trainer</strong> module provides a batteries‑included
training loop for any RHealth model built on <a href="https://torch.mlverse.org/docs" class="external-link">torch</a>. It
mirrors PyHealth’s Python trainer, bringing familiar conveniences to the
R ecosystem:</p>
<ul>
<li>dynamic <strong><code>steps_per_epoch</code></strong> (loop over a
dataloader indefinitely);</li>
<li>smart <strong>weight‑decay parameter groups</strong> (skip bias /
LayerNorm);</li>
<li>automatic <strong>gradient clipping</strong>;</li>
<li>experiment folders with <strong>file logging</strong> via
<code>{futile.logger}</code>;</li>
<li>optional <strong>CLI progress bars</strong>
(<code><a href="https://cli.r-lib.org/reference/cli_progress_bar.html" class="external-link">cli::cli_progress_bar()</a></code>).</li>
</ul>
<hr>
<div class="section level4">
<h4 id="utility-helpers">4.1 Utility helpers<a class="anchor" aria-label="anchor" href="#utility-helpers"></a>
</h4>
<table class="table">
<colgroup>
<col width="52%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>set_logger(log_path)</code></td>
<td>Initialise <code>{futile.logger}</code> to write a timestamped
log‑file.</td>
</tr>
<tr class="even">
<td><code>is_best(best, current, criterion)</code></td>
<td>Compare scores for early‑stopping (criterion = <code>"max"</code> or
<code>"min"</code>).</td>
</tr>
<tr class="odd">
<td><code>create_directory(dir)</code></td>
<td>Recursive <code>dir.create</code> wrapper.</td>
</tr>
<tr class="even">
<td><code>get_metrics_fn(mode)</code></td>
<td>Returns a metric‑calculation function
(<code>binary_metrics_fn</code>, <code>multiclass_metrics_fn</code>,
…).</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div class="section level4">
<h4 id="trainer-api">4.2 <code>Trainer</code> API<a class="anchor" aria-label="anchor" href="#trainer-api"></a>
</h4>
<table class="table">
<colgroup>
<col width="38%">
<col width="61%">
</colgroup>
<thead><tr class="header">
<th>Member</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Fields</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>model</code></td>
<td>A <a href="https://torch.mlverse.org/docs" class="external-link">torch</a> model (inherits from
<code>BaseModel</code>).</td>
</tr>
<tr class="odd">
<td><code>device</code></td>
<td>
<code>"cpu"</code> or <code>"cuda"</code> (auto‑detected if
<code>device = NULL</code>).</td>
</tr>
<tr class="even">
<td><code>metrics</code></td>
<td>Character vector passed to the metric function.</td>
</tr>
<tr class="odd">
<td><code>exp_path</code></td>
<td>Folder where logs &amp; checkpoints are saved
(<code>./output/&lt;timestamp&gt;</code>).</td>
</tr>
<tr class="even">
<td><strong>Key methods</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>initialize(model, ...)</code></td>
<td>Sets device, logging, loads checkpoint if provided.</td>
</tr>
<tr class="even">
<td><code>train(train_dataloader, val_dataloader, …)</code></td>
<td>Full training loop with early‑stopping and test evaluation.</td>
</tr>
<tr class="odd">
<td><code>inference(dataloader, additional_outputs = NULL)</code></td>
<td>Run model in <code><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval()</a></code> mode and gather predictions.</td>
</tr>
<tr class="even">
<td><code>evaluate(dataloader)</code></td>
<td>
<code>inference()</code> + compute metrics &amp; loss.</td>
</tr>
<tr class="odd">
<td>
<code>save_ckpt(path)</code> / <code>load_ckpt(path)</code>
</td>
<td>Torch native <code>state_dict</code> persistence.</td>
</tr>
</tbody>
</table>
<div class="section level5">
<h5 id="train-arguments-excerpt">4.2.1 <code>train()</code> arguments (excerpt)<a class="anchor" aria-label="anchor" href="#train-arguments-excerpt"></a>
</h5>
<table class="table">
<colgroup>
<col width="35%">
<col width="32%">
<col width="32%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Default</th>
<th>Meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>epochs</code></td>
<td><code>5</code></td>
<td>Number of passes over the data.</td>
</tr>
<tr class="even">
<td><code>optimizer_class</code></td>
<td><code>optim_adam</code></td>
<td>Any <a href="https://torch.mlverse.org/docs" class="external-link">torch</a> optimiser constructor.</td>
</tr>
<tr class="odd">
<td><code>optimizer_params</code></td>
<td><code>list(lr = 1e-3)</code></td>
<td>Extra args for the optimiser.</td>
</tr>
<tr class="even">
<td><code>steps_per_epoch</code></td>
<td><code>NULL</code></td>
<td>If <code>NULL</code> uses <code>length(train_loader)</code>; else
loops/restarts to hit the target count.</td>
</tr>
<tr class="odd">
<td><code>evaluation_steps</code></td>
<td><code>1</code></td>
<td>Validate every <em>n</em> epochs.</td>
</tr>
<tr class="even">
<td><code>weight_decay</code></td>
<td><code>0</code></td>
<td>L2 penalty (excluded for bias/LayerNorm).</td>
</tr>
<tr class="odd">
<td><code>max_grad_norm</code></td>
<td><code>NULL</code></td>
<td>Clip gradients if not <code>NULL</code>.</td>
</tr>
<tr class="even">
<td><code>monitor</code></td>
<td><code>NULL</code></td>
<td>Metric to watch for best‑model checkpoint.</td>
</tr>
<tr class="odd">
<td><code>monitor_criterion</code></td>
<td><code>"max"</code></td>
<td>
<code>"max"</code> or <code>"min"</code>.</td>
</tr>
<tr class="even">
<td><code>use_progress_bar</code></td>
<td><code>TRUE</code></td>
<td>Pretty progress bar if <a href="https://cli.r-lib.org" class="external-link">cli</a> is available.</td>
</tr>
</tbody>
</table>
<hr>
</div>
</div>
<div class="section level4">
<h4 id="minimal-working-example">4.3 Minimal working example<a class="anchor" aria-label="anchor" href="#minimal-working-example"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://v1xerunt.github.io/dev/RHealth" class="external-link">RHealth</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 1.  Build dataset &amp; task -----------------------------------------------</span></span>
<span><span class="va">ds</span>      <span class="op">&lt;-</span> <span class="va">MIMIC4Dataset</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>root <span class="op">=</span> <span class="st">"~/mimic4"</span>,</span>
<span>                             tables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patients"</span>, <span class="st">"admissions"</span>, <span class="st">"labevents"</span><span class="op">)</span>,</span>
<span>                             config_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"configs/mimic4_ehr.yaml"</span>, package <span class="op">=</span> <span class="st">"RHealth"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">task</span>    <span class="op">&lt;-</span> <span class="va"><a href="../reference/InHospitalMortalityMIMIC4.html">InHospitalMortalityMIMIC4</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>input_window_hours <span class="op">=</span> <span class="fl">48</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="va">ds</span><span class="op">$</span><span class="fu">set_task</span><span class="op">(</span><span class="va">task</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span><span class="op">)</span>, <span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">val_idx</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span><span class="op">)</span>, <span class="va">train_idx</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train_loader</span> <span class="op">&lt;-</span> <span class="fu">dataloader</span><span class="op">(</span><span class="va">samples</span><span class="op">[</span><span class="va">train_idx</span><span class="op">]</span>, batch_size <span class="op">=</span> <span class="fl">32</span>, shuffle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">val_loader</span>   <span class="op">&lt;-</span> <span class="fu">dataloader</span><span class="op">(</span><span class="va">samples</span><span class="op">[</span><span class="va">val_idx</span><span class="op">]</span>,   batch_size <span class="op">=</span> <span class="fl">64</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 2.  Build model ---------------------------------------------------------</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RNN.html">RNN</a></span><span class="op">(</span><span class="va">samples</span>, embedding_dim <span class="op">=</span> <span class="fl">128</span>, hidden_dim <span class="op">=</span> <span class="fl">128</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 3.  Kick off training ---------------------------------------------------</span></span>
<span><span class="va">trainer</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Trainer.html">Trainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">model</span>,</span>
<span>                       metrics      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auroc"</span>, <span class="st">"auprc"</span><span class="op">)</span>,</span>
<span>                       output_path  <span class="op">=</span> <span class="st">"experiments"</span>,</span>
<span>                       exp_name     <span class="op">=</span> <span class="st">"mortality_rnn"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">trainer</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">train_loader</span>,</span>
<span>              val_dataloader  <span class="op">=</span> <span class="va">val_loader</span>,</span>
<span>              epochs          <span class="op">=</span> <span class="fl">10</span>,</span>
<span>              weight_decay    <span class="op">=</span> <span class="fl">1e-4</span>,</span>
<span>              max_grad_norm   <span class="op">=</span> <span class="fl">5</span>,</span>
<span>              monitor         <span class="op">=</span> <span class="st">"auroc"</span>,</span>
<span>              monitor_criterion <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span></code></pre></div>
<p>Logs &amp; checkpoints:</p>
<pre><code>experiments/
└─ mortality_rnn/
   ├─ train.log
   ├─ last.ckpt      # after every epoch
   └─ best.ckpt      # whenever AUROC improves</code></pre>
<hr>
</div>
<div class="section level4">
<h4 id="inference-evaluation">4.4 Inference &amp; evaluation<a class="anchor" aria-label="anchor" href="#inference-evaluation"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_scores</span> <span class="op">&lt;-</span> <span class="va">trainer</span><span class="op">$</span><span class="fu">evaluate</span><span class="op">(</span><span class="va">test_loader</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">test_scores</span><span class="op">)</span></span>
<span></span>
<span><span class="va">preds</span> <span class="op">&lt;-</span> <span class="va">trainer</span><span class="op">$</span><span class="fu">inference</span><span class="op">(</span><span class="va">test_loader</span>,</span>
<span>                           additional_outputs <span class="op">=</span> <span class="st">"embed"</span>,</span>
<span>                           return_patient_ids <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">preds</span><span class="op">$</span><span class="va">patient_id</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">preds</span><span class="op">$</span><span class="va">additional</span><span class="op">$</span><span class="va">embed</span><span class="op">)</span>  <span class="co"># (n_samples, feature_dim)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="medical-code-map">5. Medical Code Map<a class="anchor" aria-label="anchor" href="#medical-code-map"></a>
</h3>
<p>Our medical code mapping module provides tools to map medical codes
between and within various medical coding systems. <strong>This module
can be used independently.</strong></p>
<div class="section level4">
<h4 id="code-lookup-with-lookup_code">5.1. Code Lookup with lookup_code()<a class="anchor" aria-label="anchor" href="#code-lookup-with-lookup_code"></a>
</h4>
<p>Retrieve the description for a specific medical code.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Look up ICD-9-CM code "428.0"</span></span>
<span><span class="va">code_description</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lookup_code.html">lookup_code</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"428.0"</span>, system <span class="op">=</span> <span class="st">"ICD9CM"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">code_description</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="hierarchy-navigation">5.2. Hierarchy Navigation<a class="anchor" aria-label="anchor" href="#hierarchy-navigation"></a>
</h4>
<p>Explore relationships within coding systems. #### Get Ancestors with
get_ancestors():</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Find ancestors for ICD-9-CM code "428.22"</span></span>
<span><span class="va">ancestor_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ancestors.html">get_ancestors</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"428.22"</span>, system <span class="op">=</span> <span class="st">"ICD9CM"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ancestor_codes</span><span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="get-descendants-with-get_descendants">Get Descendants with get_descendants():<a class="anchor" aria-label="anchor" href="#get-descendants-with-get_descendants"></a>
</h5>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Find descendants for ICD-9-CM code "428"</span></span>
<span><span class="va">descendant_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_descendants.html">get_descendants</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"428"</span>, system <span class="op">=</span> <span class="st">"ICD9CM"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">descendant_codes</span><span class="op">)</span><span class="op">)</span> <span class="co"># Showing first few for brevity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Total descendants for '428':"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">descendant_codes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="cross-system-mapping-with-map_code">5.3. Cross-System Mapping with map_code()<a class="anchor" aria-label="anchor" href="#cross-system-mapping-with-map_code"></a>
</h4>
<p>Translate codes from one system to another. First, see available
mappings:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/supported_cross.html">supported_cross</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Then, map a code:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Map ICD-9-CM "428.0" to CCSCM</span></span>
<span><span class="va">mapped_ccscm_code</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_code.html">map_code</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"428.0"</span>, from <span class="op">=</span> <span class="st">"ICD9CM"</span>, to <span class="op">=</span> <span class="st">"CCSCM"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mapped_ccscm_code</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="atc-specific-utilities">5.4. ATC Specific Utilities<a class="anchor" aria-label="anchor" href="#atc-specific-utilities"></a>
</h4>
<div class="section level5">
<h5 id="atc-level-conversion-with-atc_convert">ATC Level Conversion with atc_convert():<a class="anchor" aria-label="anchor" href="#atc-level-conversion-with-atc_convert"></a>
</h5>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atc_code</span> <span class="op">&lt;-</span> <span class="st">"L01BA01"</span> <span class="co"># Methotrexate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"L1 (Anatomical Main Group):"</span>, <span class="fu"><a href="../reference/atc_convert.html">atc_convert</a></span><span class="op">(</span><span class="va">atc_code</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"L3 (Therapeutic/Pharmacological Subgroup):"</span>, <span class="fu"><a href="../reference/atc_convert.html">atc_convert</a></span><span class="op">(</span><span class="va">atc_code</span>, level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"L4 (Chemical/Therapeutic/Pharmacological Subgroup):"</span>, <span class="fu"><a href="../reference/atc_convert.html">atc_convert</a></span><span class="op">(</span><span class="va">atc_code</span>, level <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="drug-drug-interactions-ddi-with-get_ddi">Drug-Drug Interactions (DDI) with get_ddi():<a class="anchor" aria-label="anchor" href="#drug-drug-interactions-ddi-with-get_ddi"></a>
</h5>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ddi_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ddi.html">get_ddi</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"First few known Drug-Drug Interactions (ATC pairs):"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ddi_data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="current-development-and-future-plans">6 Current Development and Future Plans<a class="anchor" aria-label="anchor" href="#current-development-and-future-plans"></a>
</h3>
<p>RHealth is currently under active development. The initial phase
focuses on establishing two foundational modules:</p>
<ol style="list-style-type: decimal">
<li>
<strong>EHR Database Module:</strong> This module is being developed
to provide a standardized framework for ingesting, processing, and
managing diverse Electronic Health Record (EHR) datasets. It aims to
support public datasets like MIMIC-III, MIMIC-IV, and eICU, as well as
user-specific data formats such as OMOP-CDM. The goal is to ensure data
consistency for subsequent modeling tasks.</li>
<li>
<strong>EHR Code Mapping Module (medcode):</strong> This module,
with its core <code>medcode</code> component, facilitates mapping
between and within various medical coding systems (e.g., ICD, NDC,
RxNorm). Key functionalities like code lookup, hierarchy navigation,
cross-system mapping, and ATC utilities are already implemented, as
demonstrated in the examples above.</li>
</ol>
<p>Looking further ahead, our development roadmap includes the expansion
of RHealth with several key modules and enhancements:</p>
<ul>
<li>
<strong>Healthcare DL Core Module:</strong> This module will
integrate traditional machine learning models (e.g., Random Forests,
Support Vector Machines) and state-of-the-art healthcare-specific deep
learning models (e.g., RETAIN, AdaCare, Transformers, graph networks,
convolutional networks, recurrent networks).</li>
<li>
<strong>Prediction Task Module:</strong> This module will be
designed to handle various clinical prediction tasks using EHR data,
including patient-level predictions (e.g., mortality, disease risk),
intra-visit predictions (e.g., length of stay, drug recommendation), and
inter-visit predictions (e.g., readmission risk, future diagnoses).</li>
<li>
<strong>Support for Multi-modal Data Integration:</strong>
Enhancements to handle and integrate diverse data types beyond
structured EHR data.</li>
<li>
<strong>Clinical Trial Applications:</strong> Developing
functionalities to support research and analysis in the context of
clinical trials.</li>
<li>
<strong>Large Language Model (LLM) Enhancement:</strong> Exploring
the integration of LLMs to augment package capabilities.</li>
</ul>
<p>RHealth aims to provide the R community with a powerful and
user-friendly toolkit for healthcare predictive modeling using deep
learning. We are glad to hear your feedbacks and suggestions via email
or submitting issues.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ji Song, Zhixia Ren, Zhenbang Wu, John Wu, Chaoqi Yang, Jimeng Sun, Liantao Ma, Ewen Harrison, Junyi Gao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
