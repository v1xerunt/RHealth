% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Trainer.R
\name{Trainer}
\alias{Trainer}
\title{Generic Trainer for torch models}
\description{
An enhanced R6 trainer mirroring PyHealth's Python version. It supports:
\itemize{
\item \strong{Dynamic \code{steps_per_epoch}}: can iterate indefinitely over a dataloader to reach a target number of steps, just like Python.
\item \strong{Parameter‑group–wise weight decay}: bias and \emph{LayerNorm} parameters are excluded from L2 regularisation.
\item \strong{Gradient clipping}.
\item \strong{Optional progress bar} using \code{cli::cli_progress_bar()} (falls back to simple logging).
\item \strong{Correctly named \code{additional_outputs}} collection.
}
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{model}}{A torch model object.}

\item{\code{metrics}}{A list of metric names.}

\item{\code{device}}{The computation device ("cpu" or "cuda").}

\item{\code{exp_path}}{Path to save logs and checkpoints.}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-Trainer-new}{\code{Trainer$new()}}
\item \href{#method-Trainer-train}{\code{Trainer$train()}}
\item \href{#method-Trainer-inference}{\code{Trainer$inference()}}
\item \href{#method-Trainer-evaluate}{\code{Trainer$evaluate()}}
\item \href{#method-Trainer-save_ckpt}{\code{Trainer$save_ckpt()}}
\item \href{#method-Trainer-load_ckpt}{\code{Trainer$load_ckpt()}}
\item \href{#method-Trainer-clone}{\code{Trainer$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Trainer-new"></a>}}
\if{latex}{\out{\hypertarget{method-Trainer-new}{}}}
\subsection{Method \code{new()}}{
Initialize the Trainer.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Trainer$new(
  model,
  checkpoint_path = NULL,
  metrics = NULL,
  device = NULL,
  enable_logging = TRUE,
  output_path = NULL,
  exp_name = NULL
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{model}}{A torch model.}

\item{\code{checkpoint_path}}{Optional checkpoint path to load.}

\item{\code{metrics}}{List of metric names.}

\item{\code{device}}{Computation device.}

\item{\code{enable_logging}}{Whether to enable file logging.}

\item{\code{output_path}}{Output directory.}

\item{\code{exp_name}}{Optional experiment name.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Trainer-train"></a>}}
\if{latex}{\out{\hypertarget{method-Trainer-train}{}}}
\subsection{Method \code{train()}}{
Train the model.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Trainer$train(
  train_dataloader,
  val_dataloader = NULL,
  test_dataloader = NULL,
  epochs = 5,
  optimizer_class = optim_adam,
  optimizer_params = list(lr = 0.001),
  steps_per_epoch = NULL,
  evaluation_steps = 1L,
  weight_decay = 0,
  max_grad_norm = NULL,
  monitor = NULL,
  monitor_criterion = "max",
  load_best_model_at_last = TRUE,
  use_progress_bar = TRUE
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{train_dataloader}}{Training dataloader.}

\item{\code{val_dataloader}}{Optional validation dataloader.}

\item{\code{test_dataloader}}{Optional test dataloader.}

\item{\code{epochs}}{Number of training epochs.}

\item{\code{optimizer_class}}{Optimizer constructor.}

\item{\code{optimizer_params}}{Parameters for optimizer.}

\item{\code{steps_per_epoch}}{Optional override for steps per epoch.}

\item{\code{evaluation_steps}}{Steps between evaluations.}

\item{\code{weight_decay}}{Weight decay parameter.}

\item{\code{max_grad_norm}}{Optional gradient clipping norm.}

\item{\code{monitor}}{Metric name to monitor.}

\item{\code{monitor_criterion}}{"max" or "min".}

\item{\code{load_best_model_at_last}}{Load best model after training.}

\item{\code{use_progress_bar}}{Show training progress.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Trainer-inference"></a>}}
\if{latex}{\out{\hypertarget{method-Trainer-inference}{}}}
\subsection{Method \code{inference()}}{
Perform inference on a dataloader.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Trainer$inference(
  dataloader,
  additional_outputs = NULL,
  return_patient_ids = FALSE
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{dataloader}}{A dataloader.}

\item{\code{additional_outputs}}{Vector of additional outputs to capture.}

\item{\code{return_patient_ids}}{Whether to return patient IDs.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Trainer-evaluate"></a>}}
\if{latex}{\out{\hypertarget{method-Trainer-evaluate}{}}}
\subsection{Method \code{evaluate()}}{
Evaluate the model using a dataloader.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Trainer$evaluate(dataloader)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{dataloader}}{A dataloader to evaluate on.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Trainer-save_ckpt"></a>}}
\if{latex}{\out{\hypertarget{method-Trainer-save_ckpt}{}}}
\subsection{Method \code{save_ckpt()}}{
Save model checkpoint.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Trainer$save_ckpt(path)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{path}}{File path to save checkpoint.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Trainer-load_ckpt"></a>}}
\if{latex}{\out{\hypertarget{method-Trainer-load_ckpt}{}}}
\subsection{Method \code{load_ckpt()}}{
Load model checkpoint.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Trainer$load_ckpt(path)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{path}}{File path to load checkpoint from.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-Trainer-clone"></a>}}
\if{latex}{\out{\hypertarget{method-Trainer-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{Trainer$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
