<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>DeepRHealth::medcode Module Demo • RHealth</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DeepRHealth::medcode Module Demo">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RHealth</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/Overview.html">Overview</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/quickstart.html">Quickstart: In-Hospital Mortality Prediction with RHealth</a></li>
    <li><a class="dropdown-item" href="../articles/MedCode.html">DeepRHealth::medcode Module Demo</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/v1xerunt/RHealth/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>DeepRHealth::medcode Module Demo</h1>
            <h3 data-toc-skip class="subtitle">R/medicine 2025 Prototype
Showcase</h3>
                        <h4 data-toc-skip class="author">Zhixia Ren</h4>
            
            <h4 data-toc-skip class="date">05/25/2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/v1xerunt/RHealth/blob/main/vignettes/MedCode.rmd" class="external-link"><code>vignettes/MedCode.rmd</code></a></small>
      <div class="d-none name"><code>MedCode.rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<ul>
<li><p>Goal: Showcase the core functionalities of the
<code>DeepRHealth::medcode</code> module.</p></li>
<li><p>Supports major medical coding systems (e.g., ICD, ATC) natively
in R.</p></li>
<li><p>Built with inspiration from the Python-based
<code>PyHealth.medcode</code>.</p></li>
</ul>
<!-- --><ul>
<li>
<strong>Key Features to Demo:</strong>
<ul>
<li><p>Code Lookup</p></li>
<li><p>Hierarchy Navigation (Ancestors/Descendants)</p></li>
<li><p>Cross-System Mapping</p></li>
<li><p>ATC Specific Utilities</p></li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="environment-setup">Environment Setup<a class="anchor" aria-label="anchor" href="#environment-setup"></a>
</h2>
<p><strong>Loading Package &amp; Dependencies</strong></p>
<ul>
<li>We’ll load the package directly from source using
<code><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">devtools::load_all()</a></code>.</li>
<li>This requires running the presentation from the package’s root
directory.</li>
<li>We also load other necessary packages like <code>knitr</code>.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required libraries for loading and display</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rappdirs.r-lib.org" class="external-link">rappdirs</a></span><span class="op">)</span> <span class="co"># Used by DeepRHealth internally for caching</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fs.r-lib.org" class="external-link">fs</a></span><span class="op">)</span> <span class="co"># Used by DeepRHealth internally for caching</span></span>
<span></span>
<span><span class="co"># Load all functions, data, etc. from the DeepRHealth package source</span></span>
<span><span class="co"># IMPORTANT: Ensure R's working directory is the package root!</span></span>
<span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="st">"."</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Optional: Display where medcode data would be cached</span></span>
<span><span class="co"># cache_dir &lt;- user_cache_dir("DeepRHealth", "medcode")</span></span>
<span><span class="co"># print(paste("Data cache directory:", cache_dir))</span></span>
<span></span>
<span><span class="co"># NOTE: Assume necessary data (e.g., ICD9CM.csv) is pre-cached for demo speed.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-handling">Data Handling<a class="anchor" aria-label="anchor" href="#data-handling"></a>
</h2>
<div class="section level3">
<h3 id="download-caching">Download &amp; Caching<a class="anchor" aria-label="anchor" href="#download-caching"></a>
</h3>
<p>The package automatically downloads required medical code datasets
(CSVs) and caches them locally for faster and offline use.</p>
<ul>
<li>Uses <code>rappdirs</code> to find a user-specific cache
directory.</li>
<li>The <code><a href="../reference/download_medcode.html">download_medcode()</a></code> function checks the cache first;
only downloads if the file is missing.</li>
</ul>
<p><strong>Let’s see where the data is/will be cached:</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the platform-specific cache directory path</span></span>
<span><span class="va">cache_dir</span> <span class="op">&lt;-</span> <span class="fu">rappdirs</span><span class="fu">::</span><span class="fu"><a href="https://rappdirs.r-lib.org/reference/user_cache_dir.html" class="external-link">user_cache_dir</a></span><span class="op">(</span><span class="st">"DeepRHealth"</span>, <span class="st">"medcode"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Data cache directory:"</span>, <span class="va">cache_dir</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Data cache directory: ~/.cache/DeepRHealth"</span></span></code></pre>
<div class="section level4">
<h4 id="demonstrating-download_medcode">
<strong>Demonstrating <code>download_medcode()</code>:</strong><a class="anchor" aria-label="anchor" href="#demonstrating-download_medcode"></a>
</h4>
<p>(This step ensures the data file exists locally, downloading only if
necessary)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the dataset name (e.g., "ICD9CM")</span></span>
<span><span class="va">dataset_name</span> <span class="op">&lt;-</span> <span class="st">"ICD9CM"</span></span>
<span></span>
<span><span class="co"># Call the function - returns path. Downloads ONLY if not cached.</span></span>
<span><span class="co"># NOTE: For a live demo, ensure network access OR pre-cache the file!</span></span>
<span><span class="co">#       We assume it's pre-cached here.</span></span>
<span><span class="va">file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_medcode.html">download_medcode</a></span><span class="op">(</span>name <span class="op">=</span> <span class="va">dataset_name</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Path for"</span>, <span class="va">dataset_name</span>, <span class="st">":"</span>, <span class="va">file_path</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Path for ICD9CM : ~/.cache/RHealth/medcode/ICD9CM.csv"</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"File exists:"</span>, <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_access.html" class="external-link">file_exists</a></span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "File exists: TRUE"</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="loading-data-load_medcode">Loading Data (<code>load_medcode</code>)<a class="anchor" aria-label="anchor" href="#loading-data-load_medcode"></a>
</h3>
<p>The <code><a href="../reference/load_medcode.html">load_medcode()</a></code> function is used internally by most
other functions (<code>lookup_code</code>, <code>get_ancestors</code>,
etc.).</p>
<ol style="list-style-type: decimal">
<li><p>It first calls <code><a href="../reference/download_medcode.html">download_medcode()</a></code> to ensure the data
file is available locally.</p></li>
<li><p>Then, it reads the CSV file into an R data frame (tibble) using
<code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv</a></code>.</p></li>
</ol>
<p><strong>Example: Loading the ICD9CM data</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the data using the function</span></span>
<span><span class="co"># This implicitly calls download_medcode first</span></span>
<span><span class="va">icd9_data_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_medcode.html">load_medcode</a></span><span class="op">(</span><span class="st">"ICD9CM"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Confirm data is loaded by checking dimensions and showing first few rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Loaded ICD9CM - Dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">icd9_data_example</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">" x "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Loaded ICD9CM - Dimensions: 17736 x 3"</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"First few rows:"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "First few rows:"</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">icd9_data_example</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="9%">
<col width="85%">
</colgroup>
<thead><tr class="header">
<th align="left">code</th>
<th align="left">parent_code</th>
<th align="left">name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">806.11</td>
<td align="left">806.1</td>
<td align="left">Open fracture of C1-C4 level with complete lesion of
cord</td>
</tr>
<tr class="even">
<td align="left">642.41</td>
<td align="left">642.4</td>
<td align="left">Mild or unspecified pre-eclampsia, delivered, with or
without mention of antepartum condition</td>
</tr>
<tr class="odd">
<td align="left">647.13</td>
<td align="left">647.1</td>
<td align="left">Gonorrhea of mother, complicating pregnancy,
childbirth, or the puerperium, antepartum condition or complication</td>
</tr>
<tr class="even">
<td align="left">374.21</td>
<td align="left">374.2</td>
<td align="left">Paralytic lagophthalmos</td>
</tr>
<tr class="odd">
<td align="left">679.00</td>
<td align="left">679.0</td>
<td align="left">Maternal complications from in utero procedure,
unspecified as to episode of care or not applicable</td>
</tr>
<tr class="even">
<td align="left">013.41</td>
<td align="left">013.4</td>
<td align="left">Tuberculoma of spinal cord, bacteriological or
histological examination not done</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="feature-1-code-lookup-lookup_code">Feature 1: Code Lookup (<code>lookup_code</code>)<a class="anchor" aria-label="anchor" href="#feature-1-code-lookup-lookup_code"></a>
</h2>
<p>This function retrieves the description and potentially other details
for a specific medical code within a given coding system.</p>
<p><strong>Example: Look up ICD-9-CM code “428.0”</strong></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Input: code string and system name</span></span>
<span><span class="va">code_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lookup_code.html">lookup_code</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"428.0"</span>, system <span class="op">=</span> <span class="st">"ICD9CM"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output: A tibble/data frame row with information</span></span>
<span><span class="co"># Using kable() for potentially nicer table output in the presentation</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">code_info</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">code</th>
<th align="left">parent_code</th>
<th align="left">name</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">428.0</td>
<td align="left">428</td>
<td align="left">Congestive heart failure, unspecified</td>
</tr></tbody>
</table>
</div>
<div class="section level2">
<h2 id="feature-2-hierarchy---ancestors-get_ancestors">Feature 2: Hierarchy - Ancestors (<code>get_ancestors</code>)<a class="anchor" aria-label="anchor" href="#feature-2-hierarchy---ancestors-get_ancestors"></a>
</h2>
<p>This function navigates the code hierarchy <em>upwards</em> to find
all parent and ancestor codes.</p>
<p><strong>Example: Find ancestors for ICD-9-CM code “428.22”</strong>
(Systolic heart failure, acute on chronic)</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Input: code string and system name</span></span>
<span><span class="va">ancestors</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ancestors.html">get_ancestors</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"428.22"</span>, system <span class="op">=</span> <span class="st">"ICD9CM"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output: A character vector of ancestor codes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ancestors</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       428.22        428.2          428   420-429.99   390-459.99 </span></span>
<span><span class="co">##      "428.2"        "428" "420-429.99" "390-459.99" "001-999.99"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="feature-3-hierarchy---descendants-get_descendants">Feature 3: Hierarchy - Descendants
(<code>get_descendants</code>)<a class="anchor" aria-label="anchor" href="#feature-3-hierarchy---descendants-get_descendants"></a>
</h2>
<p>This function navigates the code hierarchy <em>downwards</em> to find
all child and descendant codes.</p>
<p><strong>Example: Find descendants for ICD-9-CM code “428”</strong>
(Heart failure)</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Input: code string and system name</span></span>
<span><span class="va">descendants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_descendants.html">get_descendants</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"428"</span>, system <span class="op">=</span> <span class="st">"ICD9CM"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output: A character vector of descendant codes (can be long!)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">descendants</span><span class="op">)</span><span class="op">)</span> <span class="co"># Show only the first few for brevity</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "428.4" "428.1" "428.0" "428.3" "428.2" "428.9"</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Total descendants found:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">descendants</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Total descendants found: 18"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="feature-4-cross-system-mapping">Feature 4: Cross-System Mapping<a class="anchor" aria-label="anchor" href="#feature-4-cross-system-mapping"></a>
</h2>
<div class="section level3">
<h3 id="feature-4a-supported-map">Feature 4a: Supported Map<a class="anchor" aria-label="anchor" href="#feature-4a-supported-map"></a>
</h3>
<p>let’s see which mappings (crosswalks) are currently supported: The
<code><a href="../reference/supported_cross.html">supported_cross()</a></code> function returns a list of identifiers
for all available code system mappings within the package.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Call the function to get the list of supported crosswalks</span></span>
<span><span class="va">available_crosswalks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/supported_cross.html">supported_cross</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the available mapping identifiers</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">available_crosswalks</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "ICD9CM_to_CCSCM"      "ICD9PROC_to_CCSPROC"  "ICD10CM_to_CCSCM"    </span></span>
<span><span class="co">## [4] "ICD10PROC_to_CCSPROC" "NDC_to_ATC"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="feature-4btranslate-codesmap_code">Feature 4b：Translate codes(<code>map_code</code>)<a class="anchor" aria-label="anchor" href="#feature-4btranslate-codesmap_code"></a>
</h3>
<p>This function translates codes from one coding system to another
using pre-defined mapping tables.</p>
<p><strong>Example: Map ICD-9-CM “428.0” to the CCSCM system</strong>
(Clinical Classifications Software)</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Input: code, source system (from), target system (to)</span></span>
<span><span class="va">mapped_code</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_code.html">map_code</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"428.0"</span>, from <span class="op">=</span> <span class="st">"ICD9CM"</span>, to <span class="op">=</span> <span class="st">"CCSCM"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output: The corresponding code(s) in the target system</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mapped_code</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "108"</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="feature-5-atc-specific-functions">Feature 5: ATC Specific Functions<a class="anchor" aria-label="anchor" href="#feature-5-atc-specific-functions"></a>
</h2>
<p>Now let’s look at utilities specifically designed for the ATC
(Anatomical Therapeutic Chemical) classification system for drugs.</p>
<div class="section level3">
<h3 id="feature-5a-atc-level-conversion-atc_convert">Feature 5a: ATC Level Conversion (<code>atc_convert</code>)<a class="anchor" aria-label="anchor" href="#feature-5a-atc-level-conversion-atc_convert"></a>
</h3>
<p>This utility function truncates an ATC code to get its representation
at different classification levels (L1 to L5).</p>
<p><strong>Example: Convert ATC code “L01BA01”
(Methotrexate)</strong></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atc_code</span> <span class="op">&lt;-</span> <span class="st">"L01BA01"</span></span>
<span></span>
<span><span class="co"># Get code representations at different levels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"L1 (Anatomical Main Group):"</span>, <span class="fu"><a href="../reference/atc_convert.html">atc_convert</a></span><span class="op">(</span><span class="va">atc_code</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># L</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "L1 (Anatomical Main Group): L"</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"L3 (Therapeutic Subgroup):"</span>, <span class="fu"><a href="../reference/atc_convert.html">atc_convert</a></span><span class="op">(</span><span class="va">atc_code</span>, level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># L01</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "L3 (Therapeutic Subgroup): L01"</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"L4 (Chemical Subgroup):"</span>, <span class="fu"><a href="../reference/atc_convert.html">atc_convert</a></span><span class="op">(</span><span class="va">atc_code</span>, level <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># L01B</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "L4 (Chemical Subgroup): L01B"</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Level 5 is usually the full substance code</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="feature-5b-atc-drug-drug-interactions-get_ddi">Feature 5b: ATC Drug-Drug Interactions (<code>get_ddi</code>)<a class="anchor" aria-label="anchor" href="#feature-5b-atc-drug-drug-interactions-get_ddi"></a>
</h3>
<p>This function loads a predefined dataset of potential Drug-Drug
Interactions (DDIs), typically represented by pairs of interacting ATC
codes.</p>
<p><strong>Example: Load and view the first few DDI pairs</strong></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the DDI dataset bundled with the package/data</span></span>
<span><span class="va">ddi_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ddi.html">get_ddi</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the structure (first few rows)</span></span>
<span><span class="co"># Assumes columns are ATC_i, ATC_j</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ddi_data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">ATC_i</th>
<th align="left">ATC_j</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">S01AA19</td>
<td align="left">N01AH01</td>
</tr>
<tr class="even">
<td align="left">S01AA19</td>
<td align="left">N02AB03</td>
</tr>
<tr class="odd">
<td align="left">J01CA01</td>
<td align="left">N01AH01</td>
</tr>
<tr class="even">
<td align="left">J01CA01</td>
<td align="left">N02AB03</td>
</tr>
<tr class="odd">
<td align="left">N01AB08</td>
<td align="left">R03DA05</td>
</tr>
<tr class="even">
<td align="left">J01XX08</td>
<td align="left">J01DH03</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Optionally, show total number of interactions listed</span></span>
<span><span class="co"># print(paste("Total DDI records loaded:", nrow(ddi_data)))</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summary-future-work">Summary &amp; Future Work<a class="anchor" aria-label="anchor" href="#summary-future-work"></a>
</h2>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<ul>
<li>
<code>medcode</code> enables standardized handling of clinical code
vocabularies</li>
<li>Unified functions for code lookup, hierarchy navigation, and
cross-system mapping</li>
<li>Easily extendable to support new coding systems or custom
vocabularies</li>
<li>Ready for integration into R-based medical informatics
pipelines</li>
</ul>
</div>
<div class="section level3">
<h3 id="next-stepfuture-work">Next step/Future work<a class="anchor" aria-label="anchor" href="#next-stepfuture-work"></a>
</h3>
<ul>
<li>
<strong>Finalize Vignettes:</strong> Complete detailed tutorials
(vignettes) showcasing common use cases and workflows.</li>
<li>
<strong>Complete <code>pkgdown</code> Website:</strong> Finish the
documentation website for easy access to all documentation (including
existing help pages) and examples.</li>
<li>
<strong>Expand Coverage:</strong> Add support for more coding
systems and mapping tables based on user needs.</li>
<li>
<strong>Implement Testing:</strong> Create comprehensive unit tests
using <code>testthat</code> to ensure code quality and stability.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ji Song, Zhixia Ren, Zhenbang Wu, John Wu, Chaoqi Yang, Jimeng Sun, Liantao Ma, Ewen Harrison, Junyi Gao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
